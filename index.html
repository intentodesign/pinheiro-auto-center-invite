<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reinaugura√ß√£o Pinheiro Auto Center</title>
    <meta name="description" content="Convite para a reinaugura√ß√£o da Pinheiro Auto Center - 40 anos cortando problemas pela raiz">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöó</text></svg>">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Goli&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash-screen" class="screen active">
        <div class="splash-content">
            <div class="splash-background"></div>
            <div class="splash-logo-container">
                <img src="images/logo/pinheiro-logo.png" alt="Pinheiro Auto Center Logo" class="splash-logo">
                <div class="splash-text">
                    <h1>PINHEIRO AUTO CENTER</h1>
                    <p>40 Anos Cortando Problemas Pela Raiz</p>
                </div>
            </div>
            <div class="splash-loading">
                <div class="loading-spinner"></div>
                <p>Carregando convite...</p>
            </div>
        </div>
    </div>

    <!-- Main Invite Screen -->
    <div id="main-invite" class="screen">
        <header class="main-header">
            <div class="header-background"></div>
            <div class="header-content">
                <img src="images/logo/pinheiro-logo.png" alt="Pinheiro Auto Center Logo" class="header-logo">
                <p class="header-subtitle">40 Anos Cortando Problemas Pela Raiz</p>
            </div>
        </header>

        <div class="main-content">
            <div class="invite-title">
                <h2>VOC√ä EST√Å CONVIDADO</h2>
                <p>REINAUGURA√á√ÉO PINHEIRO AUTO CENTER</p>
            </div>

            <div class="event-card">
                <div class="event-info">
                    <div class="info-item">
                        <i data-lucide="calendar"></i>
                        <div>
                            <p class="info-title">19 DE AGOSTO DE 2025</p>
                            <p class="info-subtitle">Ter√ßa-feira</p>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <i data-lucide="clock"></i>
                        <div>
                            <p class="info-text">15:00 √†s 21:00</p>
                        </div>
                    </div>
                    
                    <div class="info-item">
                        <i data-lucide="map-pin"></i>
                        <div>
                            <p class="info-title">Pinheiro Auto Center</p>
                            <p class="info-subtitle">Santo Ant√¥nio da Patrulha/RS</p>
                            <p class="info-address">R. Renato Randazzo, 75 - Pitangueiras</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="personal-message">
                <div class="message-card">
                    <p>Depois de meses preparando cada detalhe, chegou a hora de abrir as portas da nova Pinheiro Auto Center.</p>
                    <p class="message-highlight">A estrutura mudou. O compromisso com voc√™, n√£o.</p>
                    <p>Queremos te receber pessoalmente para mostrar o que evolu√≠mos ‚Äî e por que isso √© bom para voc√™ e seu carro.</p>
                    <p class="message-closing">Te esperamos no dia 19/08 pra viver esse novo cap√≠tulo com a gente.</p>
                </div>
            </div>

            <div class="action-buttons">
                <button id="confirm-presence-btn" class="btn btn-primary">
                    CONFIRMAR PRESEN√áA
                </button>
                <button id="open-maps-btn" class="btn btn-outline">
                    ABRIR NO GOOGLE MAPS
                </button>
                <button id="add-calendar-btn" class="btn btn-outline-dark">
                    ADICIONAR √Ä AGENDA
                </button>
            </div>
        </div>
    </div>

    <!-- Confirmation Form Screen -->
    <div id="confirmation-form" class="screen">
        <header class="form-header">
            <button id="form-back-btn" class="back-button">
                <i data-lucide="arrow-left"></i>
            </button>
            <img src="images/logo/pinheiro-logo.png" alt="Pinheiro Auto Center Logo" class="header-logo-small">
            <div id="connection-indicator" class="connection-indicator">
                <i data-lucide="wifi" class="online"></i>
                <i data-lucide="wifi-off" class="offline" style="display: none;"></i>
            </div>
        </header>

        <div class="form-content">
            <div class="form-title">
                <h2>CONFIRME SUA PRESEN√áA</h2>
                <p>Queremos receb√™-lo da melhor forma!</p>
            </div>

            <div id="connection-warning" class="alert alert-warning" style="display: none;">
                <i data-lucide="wifi-off"></i>
                <span>Sem conex√£o com a internet. Verifique sua conex√£o antes de confirmar.</span>
            </div>

            <div id="submit-error" class="alert alert-error" style="display: none;">
                <i data-lucide="alert-circle"></i>
                <span id="error-message"></span>
            </div>

            <div class="form-card">
                <form id="presence-form">
                    <div class="form-field">
                        <label for="name">
                            <i data-lucide="user"></i>
                            SEU NOME COMPLETO
                        </label>
                        <input type="text" id="name" name="name" placeholder="Digite seu nome completo" required>
                        <div class="field-error" id="name-error"></div>
                    </div>

                    <div class="form-field">
                        <label for="phone">
                            <i data-lucide="phone"></i>
                            SEU TELEFONE
                        </label>
                        <input type="tel" id="phone" name="phone" placeholder="(51) 99999-9999" maxlength="15" required>
                        <div class="field-error" id="phone-error"></div>
                    </div>

                    <div class="form-field">
                        <label for="guests">
                            <i data-lucide="users"></i>
                            QUANTOS ACOMPANHANTES?
                        </label>
                        <select id="guests" name="guests" required>
                            <option value="">Selecione quantos acompanhantes</option>
                            <option value="0">Vou sozinho(a)</option>
                            <option value="1">1 acompanhante</option>
                            <option value="2">2 acompanhantes</option>
                            <option value="3">3 acompanhantes</option>
                            <option value="4">4 acompanhantes</option>
                            <option value="5">5 ou mais acompanhantes</option>
                        </select>
                        <div class="field-error" id="guests-error"></div>
                    </div>

                    <button type="submit" id="submit-btn" class="btn btn-primary btn-large">
                        <span class="submit-text">CONFIRMAR PRESEN√áA</span>
                        <div class="loading-spinner" style="display: none;"></div>
                    </button>

                    <button type="button" id="form-back-text" class="btn btn-text">
                        Voltar
                    </button>
                </form>
            </div>

            <div class="form-info">
                <p>Sua confirma√ß√£o ser√° processada automaticamente</p>
            </div>
        </div>
    </div>

    <!-- Success Screen -->
    <div id="success-screen" class="screen">
        <header class="success-header">
            <div class="header-background"></div>
            <div class="header-content">
                <img src="images/logo/pinheiro-logo.png" alt="Pinheiro Auto Center Logo" class="header-logo">
            </div>
        </header>

        <div class="success-content">
            <div class="success-message">
                <div class="success-icon">
                    <i data-lucide="check-circle"></i>
                </div>
                <h2>PRESEN√áA CONFIRMADA!</h2>
                <p>Obrigado por confirmar! Estamos ansiosos para receb√™-lo na reinaugura√ß√£o da Pinheiro Auto Center.</p>
            </div>

            <div class="success-details">
                <h3>LEMBRE-SE:</h3>
                <div class="reminder-item">
                    <i data-lucide="calendar"></i>
                    <span><strong>19 de Agosto de 2025</strong> √†s 15:00</span>
                </div>
                <div class="reminder-item">
                    <i data-lucide="map-pin"></i>
                    <span>R. Renato Randazzo, 75 - Pitangueiras</span>
                </div>
            </div>

            <div class="video-container">
                <h3>CONHE√áA NOSSA HIST√ìRIA:</h3>
                <div class="video-wrapper">
                    <iframe 
                        src="https://www.youtube.com/embed/nDfyZpRJ1RY" 
                        title="Pinheiro Auto Center - Nossa Hist√≥ria"
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
            </div>

            <div class="success-actions">
                <button id="success-maps-btn" class="btn btn-outline">
                    <i data-lucide="map-pin"></i>
                    ABRIR NO GOOGLE MAPS
                </button>
                <button id="success-calendar-btn" class="btn btn-outline-dark">
                    <i data-lucide="calendar"></i>
                    ADICIONAR √Ä AGENDA
                </button>
            </div>
        </div>
    </div>

    <!-- Debug Panel -->
    <div id="debug-panel" class="debug-panel">
        <button id="debug-toggle" class="debug-toggle">
            <i data-lucide="alert-circle"></i>
            <span id="debug-count" class="debug-count" style="display: none;">0</span>
        </button>
        
        <div id="debug-content" class="debug-content" style="display: none;">
            <div class="debug-header">
                <h3>
                    <i data-lucide="alert-circle"></i>
                    Debug Panel
                </h3>
                <button id="debug-close" class="debug-close">√ó</button>
            </div>
            
            <div id="debug-body" class="debug-body">
                <p class="debug-info">Nenhum dado em backup. Todas as confirma√ß√µes foram enviadas com sucesso!</p>
            </div>
            
            <div id="debug-actions" class="debug-actions" style="display: none;">
                <button id="debug-download" class="btn btn-small">
                    <i data-lucide="download"></i>
                    Download
                </button>
                <button id="debug-clear" class="btn btn-small btn-danger">
                    <i data-lucide="trash-2"></i>
                    Limpar
                </button>
            </div>
            
            <div class="debug-footer">
                <strong>Info:</strong> Este painel mostra confirma√ß√µes que falharam ao enviar para a planilha. 
                Os dados ficam salvos localmente como backup.
            </div>
        </div>
    </div>

    <!-- Apps Script Instructions Modal -->
    <div id="instructions-modal" class="modal">
        <button id="instructions-toggle" class="instructions-toggle">
            <i data-lucide="alert-triangle"></i>
        </button>
        
        <div id="instructions-overlay" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>
                        <i data-lucide="alert-triangle"></i>
                        Configura√ß√£o do Google Apps Script
                    </h2>
                    <button id="instructions-close" class="modal-close">√ó</button>
                </div>
                
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i data-lucide="alert-triangle"></i>
                        Se voc√™ est√° vendo erros de "Failed to fetch", siga estas instru√ß√µes para configurar corretamente o Google Apps Script.
                    </div>
                    
                    <div class="instruction-step">
                        <h3>
                            <i data-lucide="check-circle"></i>
                            Passo 1: Atualize o c√≥digo do Apps Script
                        </h3>
                        <div class="code-block">
                            <div class="code-header">
                                <span>google-apps-script-updated.js</span>
                                <button id="copy-code" class="copy-btn">
                                    <i data-lucide="copy"></i>
                                </button>
                            </div>
                            <pre id="script-code">function doPost(e) {
  return handleRequest(e, 'POST');
}

function doGet(e) {
  return handleRequest(e, 'GET');
}

function handleRequest(e, method) {
  try {
    // ID da sua planilha
    const SPREADSHEET_ID = '1sm8MuG-yLiKI7gGBhdCO-vO2VRAVqLVT6HnPyEXtewU';
    const sheet = SpreadsheetApp.openById(SPREADSHEET_ID).getActiveSheet();
    
    let nome, telefone, acompanhantes;
    
    if (method === 'POST') {
      if (e.postData && e.postData.contents) {
        try {
          const data = JSON.parse(e.postData.contents);
          nome = data.name;
          telefone = data.phone;
          acompanhantes = data.guests;
        } catch (parseError) {
          nome = e.parameter.name;
          telefone = e.parameter.phone;
          acompanhantes = e.parameter.guests;
        }
      } else {
        nome = e.parameter.name;
        telefone = e.parameter.phone;
        acompanhantes = e.parameter.guests;
      }
    } else {
      nome = e.parameter.name;
      telefone = e.parameter.phone;
      acompanhantes = e.parameter.guests;
    }
    
    if (!nome || !telefone || acompanhantes === undefined) {
      throw new Error('Dados incompletos');
    }
    
    const timestamp = new Date();
    sheet.appendRow([timestamp, nome, telefone, acompanhantes, 'Confirmado', method]);
    
    return ContentService
      .createTextOutput(JSON.stringify({
        status: 'success', 
        message: 'Presen√ßa confirmada com sucesso!'
      }))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({
        status: 'error', 
        message: error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}</pre>
                        </div>
                    </div>
                    
                    <!-- More instruction steps would go here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading overlay for form submission -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner large"></div>
            <p>Confirmando presen√ßa...</p>
        </div>
    </div>

    <!-- Main JavaScript -->
    <script src="js/app.js"></script>
</body>
</html>